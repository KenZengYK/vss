unit aqlreport01formu;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, DB, DBClient, ppBands, ppVar, ppClass, jpeg, ppMemo, ppCtrls,
  ppReport, ppStrtch, ppSubRpt, ppPrnabl, ppCache, ppProd, ppComm,
  ppRelatv, ppDB, ppDBPipe, StdCtrls, ExtCtrls, ppViewr, Txcomp;

type
  Tfrmaqlreport01 = class(TForm)
    xh1: TRadioGroup;
    ppDBPipeline1: TppDBPipeline;
    ppReport1: TppReport;
    ppHeaderBand1: TppHeaderBand;
    ppDetailBand1: TppDetailBand;
    ppLine1: TppLine;
    ppFooterBand1: TppFooterBand;
    ppSummaryBand1: TppSummaryBand;
    ppSubReport1: TppSubReport;
    ppChildReport1: TppChildReport;
    ppTitleBand1: TppTitleBand;
    ppShape51: TppShape;
    ppShape48: TppShape;
    ppShape41: TppShape;
    ppShape42: TppShape;
    ppShape32: TppShape;
    ppShape30: TppShape;
    ppShape29: TppShape;
    ppShape28: TppShape;
    ppShape26: TppShape;
    ppImage4: TppImage;
    ppImage5: TppImage;
    ppImage6: TppImage;
    ppShape23: TppShape;
    ppShape24: TppShape;
    ppLabel104: TppLabel;
    ppDBText20: TppDBText;
    ppLabel105: TppLabel;
    ppDBText21: TppDBText;
    ppLabel106: TppLabel;
    ppDBText22: TppDBText;
    ppShape27: TppShape;
    ppLabel107: TppLabel;
    ppDBText23: TppDBText;
    ppShape31: TppShape;
    ppLabel108: TppLabel;
    ppDBText24: TppDBText;
    ppShape33: TppShape;
    ppLabel109: TppLabel;
    ppShape35: TppShape;
    ppShape39: TppShape;
    ppShape40: TppShape;
    ppLabel64: TppLabel;
    ppDBText49: TppDBText;
    ppLabel112: TppLabel;
    ppLine87: TppLine;
    ppLabel113: TppLabel;
    ppLabel114: TppLabel;
    ppLine88: TppLine;
    ppShape43: TppShape;
    ppLine89: TppLine;
    ppLabel115: TppLabel;
    ppLabel116: TppLabel;
    ppShape44: TppShape;
    ppLine90: TppLine;
    ppLine91: TppLine;
    ppLine92: TppLine;
    ppLine93: TppLine;
    ppLine94: TppLine;
    ppLine95: TppLine;
    ppLine96: TppLine;
    ppLine97: TppLine;
    ppLine98: TppLine;
    ppLine99: TppLine;
    ppLine100: TppLine;
    ppLine101: TppLine;
    ppLine102: TppLine;
    ppLine103: TppLine;
    ppLine104: TppLine;
    ppLine105: TppLine;
    ppLine106: TppLine;
    ppLine107: TppLine;
    ppLine108: TppLine;
    ppLine109: TppLine;
    ppLine110: TppLine;
    ppLine111: TppLine;
    ppLine112: TppLine;
    ppLine113: TppLine;
    ppLine114: TppLine;
    ppLine115: TppLine;
    ppLine116: TppLine;
    ppLine117: TppLine;
    ppLine118: TppLine;
    ppLine119: TppLine;
    ppLine120: TppLine;
    ppLine121: TppLine;
    ppLine122: TppLine;
    ppLine123: TppLine;
    ppLine124: TppLine;
    ppShape45: TppShape;
    ppLine125: TppLine;
    ppShape46: TppShape;
    ppLine126: TppLine;
    ppLine127: TppLine;
    ppLine128: TppLine;
    ppLine129: TppLine;
    ppLine130: TppLine;
    ppLine132: TppLine;
    ppLine133: TppLine;
    ppLine134: TppLine;
    ppLine135: TppLine;
    ppLine136: TppLine;
    ppLine137: TppLine;
    ppLine138: TppLine;
    ppLine139: TppLine;
    ppLine140: TppLine;
    ppLine141: TppLine;
    ppLine142: TppLine;
    ppLine131: TppLine;
    ppLine145: TppLine;
    ppLine146: TppLine;
    ppShape49: TppShape;
    ppShape50: TppShape;
    ppLabel117: TppLabel;
    ppLabel118: TppLabel;
    ppLabel119: TppLabel;
    ppLabel120: TppLabel;
    ppLabel121: TppLabel;
    ppLabel122: TppLabel;
    ppLabel123: TppLabel;
    ppLine143: TppLine;
    ppLabel124: TppLabel;
    ppLabel125: TppLabel;
    ppLabel126: TppLabel;
    ppDBText50: TppDBText;
    ppLabel127: TppLabel;
    ppLabel128: TppLabel;
    ppShape47: TppShape;
    ppLine144: TppLine;
    ppLine147: TppLine;
    ppLabel129: TppLabel;
    ppLabel130: TppLabel;
    ppLabel131: TppLabel;
    ppLabel132: TppLabel;
    ppLabel133: TppLabel;
    ppLabel134: TppLabel;
    ppLabel135: TppLabel;
    ppLine148: TppLine;
    ppLine149: TppLine;
    ppLine150: TppLine;
    ppLabel136: TppLabel;
    ppLabel137: TppLabel;
    ppMemo1: TppMemo;
    ppLabel138: TppLabel;
    ppLine151: TppLine;
    ppLabel139: TppLabel;
    ppLine152: TppLine;
    ppDBText51: TppDBText;
    ppDBText52: TppDBText;
    ppDBText53: TppDBText;
    ppImage7: TppImage;
    ppImage8: TppImage;
    rx001: TppLabel;
    sd005: TppLabel;
    sd006: TppLabel;
    se005: TppLabel;
    rx002: TppLabel;
    rx003: TppLabel;
    rx004: TppLabel;
    rx005: TppLabel;
    rd001: TppLabel;
    rd002: TppLabel;
    rd003: TppLabel;
    rd004: TppLabel;
    rd005: TppLabel;
    rd006: TppLabel;
    rd011: TppLabel;
    rd012: TppLabel;
    rd013: TppLabel;
    rd014: TppLabel;
    rd015: TppLabel;
    rd016: TppLabel;
    rd021: TppLabel;
    rd031: TppLabel;
    rd032: TppLabel;
    rd022: TppLabel;
    rd033: TppLabel;
    rd023: TppLabel;
    rd034: TppLabel;
    rd024: TppLabel;
    rd035: TppLabel;
    rd025: TppLabel;
    rd036: TppLabel;
    rd026: TppLabel;
    rd041: TppLabel;
    rd051: TppLabel;
    rd061: TppLabel;
    rd071: TppLabel;
    rd072: TppLabel;
    rd062: TppLabel;
    rd052: TppLabel;
    rd042: TppLabel;
    rd073: TppLabel;
    rd063: TppLabel;
    rd053: TppLabel;
    rd043: TppLabel;
    rd074: TppLabel;
    rd064: TppLabel;
    rd054: TppLabel;
    rd044: TppLabel;
    rd075: TppLabel;
    rd065: TppLabel;
    rd055: TppLabel;
    rd045: TppLabel;
    rd046: TppLabel;
    rd056: TppLabel;
    rd066: TppLabel;
    rd076: TppLabel;
    rd081: TppLabel;
    rd091: TppLabel;
    rd101: TppLabel;
    rd111: TppLabel;
    rd112: TppLabel;
    rd102: TppLabel;
    rd092: TppLabel;
    rd082: TppLabel;
    rd113: TppLabel;
    rd103: TppLabel;
    rd093: TppLabel;
    rd083: TppLabel;
    rd114: TppLabel;
    rd104: TppLabel;
    rd094: TppLabel;
    rd084: TppLabel;
    rd115: TppLabel;
    rd105: TppLabel;
    rd095: TppLabel;
    rd085: TppLabel;
    rd086: TppLabel;
    rd096: TppLabel;
    rd106: TppLabel;
    rd116: TppLabel;
    re001: TppLabel;
    re002: TppLabel;
    re003: TppLabel;
    re004: TppLabel;
    re005: TppLabel;
    re011: TppLabel;
    re012: TppLabel;
    re013: TppLabel;
    re014: TppLabel;
    re015: TppLabel;
    re021: TppLabel;
    re031: TppLabel;
    re032: TppLabel;
    re022: TppLabel;
    re033: TppLabel;
    re023: TppLabel;
    re034: TppLabel;
    re024: TppLabel;
    re035: TppLabel;
    re025: TppLabel;
    rd121: TppLabel;
    rd131: TppLabel;
    rd141: TppLabel;
    rd151: TppLabel;
    rd152: TppLabel;
    rd142: TppLabel;
    rd132: TppLabel;
    rd122: TppLabel;
    rd153: TppLabel;
    rd143: TppLabel;
    rd133: TppLabel;
    rd123: TppLabel;
    rd154: TppLabel;
    rd144: TppLabel;
    rd134: TppLabel;
    rd124: TppLabel;
    rd155: TppLabel;
    rd145: TppLabel;
    rd135: TppLabel;
    rd125: TppLabel;
    rd126: TppLabel;
    rd136: TppLabel;
    rd146: TppLabel;
    rd156: TppLabel;
    re041: TppLabel;
    re051: TppLabel;
    re061: TppLabel;
    re071: TppLabel;
    re072: TppLabel;
    re062: TppLabel;
    re052: TppLabel;
    re042: TppLabel;
    re073: TppLabel;
    re063: TppLabel;
    re053: TppLabel;
    re043: TppLabel;
    re074: TppLabel;
    re064: TppLabel;
    re054: TppLabel;
    re044: TppLabel;
    re075: TppLabel;
    re065: TppLabel;
    re055: TppLabel;
    re045: TppLabel;
    frep001: TppLabel;
    ppDBText54: TppDBText;
    ppImage10: TppImage;
    ppImage12: TppImage;
    ppImage14: TppImage;
    ppImage16: TppImage;
    ppDetailBand2: TppDetailBand;
    ppLine86: TppLine;
    ppSummaryBand2: TppSummaryBand;
    ppGroup1: TppGroup;
    ppGroupHeaderBand1: TppGroupHeaderBand;
    ppShape6: TppShape;
    ppShape52: TppShape;
    ppShape1: TppShape;
    ppShape7: TppShape;
    ppShape18: TppShape;
    ppShape19: TppShape;
    ppShape17: TppShape;
    ppShape16: TppShape;
    ppShape13: TppShape;
    ppShape14: TppShape;
    ppShape15: TppShape;
    ppShape12: TppShape;
    ppShape11: TppShape;
    ppShape10: TppShape;
    ppShape8: TppShape;
    ppLine42: TppLine;
    ppLine43: TppLine;
    ppImage1: TppImage;
    ppImage2: TppImage;
    ppImage3: TppImage;
    ppLabel1: TppLabel;
    ppDBText1: TppDBText;
    ppLabel2: TppLabel;
    ppDBText2: TppDBText;
    ppLabel3: TppLabel;
    ppDBText3: TppDBText;
    ppLabel4: TppLabel;
    ppDBText4: TppDBText;
    ppLabel5: TppLabel;
    ppDBText5: TppDBText;
    ppLabel6: TppLabel;
    ppDBText6: TppDBText;
    ppDBText7: TppDBText;
    ppDBText8: TppDBText;
    ppDBText9: TppDBText;
    ppDBText10: TppDBText;
    ppDBText11: TppDBText;
    ppDBText12: TppDBText;
    ppLabel7: TppLabel;
    ppDBText13: TppDBText;
    ppLabel8: TppLabel;
    ppDBText14: TppDBText;
    ppLabel9: TppLabel;
    ppDBText15: TppDBText;
    ppLabel10: TppLabel;
    ppDBText16: TppDBText;
    ppLine2: TppLine;
    ppLine3: TppLine;
    ppLabel11: TppLabel;
    ppShape2: TppShape;
    ppLabel12: TppLabel;
    ppLine4: TppLine;
    ppLine5: TppLine;
    ppLine6: TppLine;
    ppLine7: TppLine;
    ppLine8: TppLine;
    ppLabel13: TppLabel;
    ppLabel14: TppLabel;
    ppLabel15: TppLabel;
    ppLabel16: TppLabel;
    ppLine9: TppLine;
    ppLine10: TppLine;
    ppLine11: TppLine;
    ppLine12: TppLine;
    ppLine13: TppLine;
    ppLine14: TppLine;
    ppLine15: TppLine;
    ppLine16: TppLine;
    ppLine17: TppLine;
    ppLine18: TppLine;
    ppLine19: TppLine;
    ppLabel17: TppLabel;
    ppLabel18: TppLabel;
    ppLabel19: TppLabel;
    ppLabel20: TppLabel;
    ppLabel21: TppLabel;
    ppLabel22: TppLabel;
    ppLabel23: TppLabel;
    ppLabel24: TppLabel;
    ppLabel25: TppLabel;
    ppLabel26: TppLabel;
    ppLabel27: TppLabel;
    ppLabel28: TppLabel;
    ppLabel29: TppLabel;
    ppLine78: TppLine;
    ppLine79: TppLine;
    ppLine80: TppLine;
    ppLabel35: TppLabel;
    ppLine81: TppLine;
    ppLine82: TppLine;
    ppLine83: TppLine;
    ppLine84: TppLine;
    ppLine85: TppLine;
    ppLabel33: TppLabel;
    ppLabel36: TppLabel;
    ppLabel37: TppLabel;
    ppLabel38: TppLabel;
    ppLabel39: TppLabel;
    ppLabel40: TppLabel;
    ppDBText17: TppDBText;
    ppShape9: TppShape;
    ppDBText18: TppDBText;
    ppDBText19: TppDBText;
    ppLabel65: TppLabel;
    ppLabel66: TppLabel;
    ppLabel67: TppLabel;
    ppLabel68: TppLabel;
    ppLabel69: TppLabel;
    ppLabel70: TppLabel;
    ppLabel71: TppLabel;
    ppLabel72: TppLabel;
    ppLabel73: TppLabel;
    ppLabel74: TppLabel;
    ppLabel75: TppLabel;
    ppLabel76: TppLabel;
    ppLabel77: TppLabel;
    ppLabel78: TppLabel;
    ppLabel79: TppLabel;
    ppLabel80: TppLabel;
    ppLabel81: TppLabel;
    ppLabel82: TppLabel;
    ppLabel83: TppLabel;
    ppLabel84: TppLabel;
    ppLabel85: TppLabel;
    ppLabel86: TppLabel;
    ppLabel87: TppLabel;
    ppLabel88: TppLabel;
    ppLabel89: TppLabel;
    ppLabel90: TppLabel;
    ppLabel91: TppLabel;
    ppLabel92: TppLabel;
    ppLabel93: TppLabel;
    ppLabel94: TppLabel;
    ppLabel95: TppLabel;
    ppLabel96: TppLabel;
    ppLabel97: TppLabel;
    ppLabel98: TppLabel;
    ppLabel99: TppLabel;
    ppLabel100: TppLabel;
    ppLabel101: TppLabel;
    ppLabel102: TppLabel;
    ppLabel103: TppLabel;
    rx01: TppLabel;
    rx02: TppLabel;
    ppImage9: TppImage;
    ppDBText55: TppDBText;
    ppLabel156: TppLabel;
    ppSystemVariable1: TppSystemVariable;
    ppShape25: TppShape;
    ppLabel155: TppLabel;
    ppDBText71: TppDBText;
    ppShape34: TppShape;
    ppLabel63: TppLabel;
    ppDBText56: TppDBText;
    ppImage11: TppImage;
    ppImage13: TppImage;
    ppImage15: TppImage;
    ppGroupFooterBand1: TppGroupFooterBand;
    Query1: TClientDataSet;
    Query2: TClientDataSet;
    ppGroup2: TppGroup;
    ppGroupHeaderBand2: TppGroupHeaderBand;
    ppGroupFooterBand2: TppGroupFooterBand;
    ppGroup3: TppGroup;
    ppGroupHeaderBand3: TppGroupHeaderBand;
    ppGroupFooterBand3: TppGroupFooterBand;
    ppSubReport4: TppSubReport;
    ppChildReport4: TppChildReport;
    ppTitleBand2: TppTitleBand;
    ppDetailBand3: TppDetailBand;
    ppSummaryBand3: TppSummaryBand;
    ppShape22: TppShape;
    ppLabel56: TppLabel;
    ppLabel57: TppLabel;
    ppLabel58: TppLabel;
    ppLabel59: TppLabel;
    ppLabel60: TppLabel;
    ppLabel61: TppLabel;
    ppLabel62: TppLabel;
    ppLabel32: TppLabel;
    ppDBText39: TppDBText;
    ppDBText40: TppDBText;
    ppDBText41: TppDBText;
    ppDBText42: TppDBText;
    ppDBText43: TppDBText;
    ppDBText44: TppDBText;
    ppDBText45: TppDBText;
    ppLabel34: TppLabel;
    ppDBText48: TppDBText;
    ppLabel111: TppLabel;
    sc002: TppLabel;
    sc003: TppLabel;
    sc004: TppLabel;
    sc005: TppLabel;
    sc008: TppLabel;
    sc007: TppLabel;
    sc006: TppLabel;
    remarks001: TppLabel;
    ppDBText57: TppDBText;
    ppDBText58: TppDBText;
    qry_s1: TClientDataSet;
    qry_s2: TClientDataSet;
    DataSource1: TDataSource;
    DataSource2: TDataSource;
    qry_s3: TClientDataSet;
    DataSource3: TDataSource;
    ppDBPipeline2: TppDBPipeline;
    ppDBPipeline3: TppDBPipeline;
    ppDBPipeline4: TppDBPipeline;
    ppDBText59: TppDBText;
    ppDBText60: TppDBText;
    ppDBText61: TppDBText;
    ppDBText62: TppDBText;
    ppDBText63: TppDBText;
    ppDBText64: TppDBText;
    ppShape56: TppShape;
    ppShape57: TppShape;
    ppLine180: TppLine;
    ppLine181: TppLine;
    ppLine182: TppLine;
    ppLine183: TppLine;
    ppLine184: TppLine;
    ppLine185: TppLine;
    ppLine186: TppLine;
    ppLine187: TppLine;
    ppLine188: TppLine;
    ppLine189: TppLine;
    ppLine190: TppLine;
    ppLine191: TppLine;
    ppLine192: TppLine;
    ppShape58: TppShape;
    ppSubReport2: TppSubReport;
    ppChildReport2: TppChildReport;
    ppTitleBand3: TppTitleBand;
    ppShape5: TppShape;
    ppShape38: TppShape;
    ppLabel141: TppLabel;
    ppLabel142: TppLabel;
    ppLabel143: TppLabel;
    ppLabel144: TppLabel;
    ppLabel145: TppLabel;
    ppLabel146: TppLabel;
    ppLabel147: TppLabel;
    ppLabel148: TppLabel;
    ppDBText65: TppDBText;
    ppDBText66: TppDBText;
    ppDBText67: TppDBText;
    ppDBText68: TppDBText;
    ppDBText69: TppDBText;
    ppDBText70: TppDBText;
    ppDBText72: TppDBText;
    ppLine44: TppLine;
    ppLine45: TppLine;
    ppLine46: TppLine;
    ppLine47: TppLine;
    ppLine48: TppLine;
    ppLine49: TppLine;
    ppDetailBand4: TppDetailBand;
    ppShape55: TppShape;
    ppShape59: TppShape;
    ppDBText73: TppDBText;
    ppDBText74: TppDBText;
    ppDBText75: TppDBText;
    ppDBText76: TppDBText;
    ppDBText77: TppDBText;
    ppDBText78: TppDBText;
    ppDBText79: TppDBText;
    ppDBText80: TppDBText;
    ppLine50: TppLine;
    ppLine51: TppLine;
    ppLine52: TppLine;
    ppLine53: TppLine;
    ppLine54: TppLine;
    ppLine71: TppLine;
    ppLine72: TppLine;
    ppSummaryBand4: TppSummaryBand;
    ppDBText81: TppDBText;
    ppLabel150: TppLabel;
    sa002: TppLabel;
    sa003: TppLabel;
    sa004: TppLabel;
    sa005: TppLabel;
    sa008: TppLabel;
    sa007: TppLabel;
    sa006: TppLabel;
    ppSubReport3: TppSubReport;
    ppChildReport3: TppChildReport;
    ppTitleBand4: TppTitleBand;
    ppShape3: TppShape;
    ppShape20: TppShape;
    ppLabel30: TppLabel;
    ppLabel41: TppLabel;
    ppLabel42: TppLabel;
    ppLabel43: TppLabel;
    ppLabel44: TppLabel;
    ppLabel45: TppLabel;
    ppLabel46: TppLabel;
    ppLabel47: TppLabel;
    ppDBText25: TppDBText;
    ppDBText26: TppDBText;
    ppDBText27: TppDBText;
    ppDBText28: TppDBText;
    ppDBText29: TppDBText;
    ppDBText30: TppDBText;
    ppDBText31: TppDBText;
    ppLine20: TppLine;
    ppLine21: TppLine;
    ppLine22: TppLine;
    ppLine23: TppLine;
    ppLine24: TppLine;
    ppLine25: TppLine;
    ppDetailBand5: TppDetailBand;
    ppShape36: TppShape;
    ppShape53: TppShape;
    ppDBText46: TppDBText;
    ppDBText82: TppDBText;
    ppDBText83: TppDBText;
    ppDBText84: TppDBText;
    ppDBText85: TppDBText;
    ppDBText86: TppDBText;
    ppDBText87: TppDBText;
    ppDBText88: TppDBText;
    ppLine26: TppLine;
    ppLine27: TppLine;
    ppLine28: TppLine;
    ppLine29: TppLine;
    ppLine30: TppLine;
    ppLine57: TppLine;
    ppLine58: TppLine;
    ppSummaryBand5: TppSummaryBand;
    ppDBText89: TppDBText;
    ppLabel48: TppLabel;
    sb002: TppLabel;
    sb003: TppLabel;
    sb004: TppLabel;
    sb005: TppLabel;
    sb008: TppLabel;
    sb007: TppLabel;
    sb006: TppLabel;
    ap01: TppLabel;
    ap02: TppLabel;
    procedure ppReport1PreviewFormCreate(Sender: TObject);
    procedure ppGroupHeaderBand1BeforePrint(Sender: TObject);
    procedure ppSummaryBand4BeforePrint(Sender: TObject);
    procedure ppSummaryBand5BeforePrint(Sender: TObject);
    procedure ppSummaryBand3BeforePrint(Sender: TObject);
    procedure ppTitleBand1BeforePrint(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmaqlreport01: Tfrmaqlreport01;

implementation

uses aqlmainformu, aqlreportformu;

{$R *.dfm}

procedure Tfrmaqlreport01.ppReport1PreviewFormCreate(Sender: TObject);
begin
  ppReport1.PreviewForm.WindowState:=wsMaximized;
  TppViewer(ppReport1.PreviewForm.Viewer).Zoompercentage:=100;
end;

procedure Tfrmaqlreport01.ppGroupHeaderBand1BeforePrint(Sender: TObject);
var
  s1:string;
begin
  rx01.Caption:=inttostr(frmaqlmain.qry_s0.fieldbyname('col1').value*frmaqlmain.qry_s0.fieldbyname('size1').value);
  rx02.Caption:=formatfloat('0.0',frmaqlreport.qry_s0.fieldbyname('case1').value/(frmaqlmain.qry_s0.fieldbyname('col1').value*frmaqlmain.qry_s0.fieldbyname('size1').value));
end;

procedure Tfrmaqlreport01.ppSummaryBand4BeforePrint(Sender: TObject);
var
  i:integer;
  f1,f2,f3,f4,f5,f6,f7:double;
begin
    i:=0;f1:=0;f2:=0;f3:=0;f4:=0;f5:=0;f6:=0;f7:=0;
    with query1 do begin
      close;
      params.clear;
      params.createparam(ftinteger,'x1',ptinput);
      commandtext:='select * from tbl_aql_s1 where seq=:x1 and (q1>0 or q2>0 or q3>0 or q4>0 or q5>0 or q6>0 or q7>0 or q8>0 or q9>0 or q10>0 or q11>0 or q12>0) order by seq1';
      params[0].asinteger:=frmaqlmain.qry_s0.fieldbyname('seq').value;
      open;
      first;
      while not eof do begin
        i:=i+1;
        f1:=f1+fieldbyname('q1').value;
        f2:=f2+fieldbyname('q2').value;
        f3:=f3+fieldbyname('q3').value;
        f4:=f4+fieldbyname('q4').value;
        f5:=f5+fieldbyname('q5').value;
        f6:=f6+fieldbyname('q6').value;
        f7:=f7+fieldbyname('q7').value;
        application.ProcessMessages;
        next;
      end;
    end;
    sa002.Caption:=formatfloat('#,0',f1);
    sa003.Caption:=formatfloat('#,0',f2);
    sa004.Caption:=formatfloat('#,0',f3);
    sa005.Caption:=formatfloat('#,0',f4);
    sa006.Caption:=formatfloat('#,0',f5);
    sa007.Caption:=formatfloat('#,0',f6);
    sa008.Caption:=formatfloat('#,0',f7);
end;

procedure Tfrmaqlreport01.ppSummaryBand5BeforePrint(Sender: TObject);
var
  i:integer;
  f1,f2,f3,f4,f5,f6,f7:double;
begin
    i:=0;f1:=0;f2:=0;f3:=0;f4:=0;f5:=0;f6:=0;f7:=0;
    with query1 do begin
      close;
      params.clear;
      params.createparam(ftinteger,'x1',ptinput);
      commandtext:='select * from tbl_aql_s2 where seq=:x1 and (q1>0 or q2>0 or q3>0 or q4>0 or q5>0 or q6>0 or q7>0 or q8>0 or q9>0 or q10>0 or q11>0 or q12>0) order by seq1';
      params[0].asinteger:=frmaqlmain.qry_s0.fieldbyname('seq').value;
      open;
      first;
      while not eof do begin
        i:=i+1;
        f1:=f1+fieldbyname('q1').value;
        f2:=f2+fieldbyname('q2').value;
        f3:=f3+fieldbyname('q3').value;
        f4:=f4+fieldbyname('q4').value;
        f5:=f5+fieldbyname('q5').value;
        f6:=f6+fieldbyname('q6').value;
        f7:=f7+fieldbyname('q7').value;
        application.ProcessMessages;
        next;
      end;
    end;
    sb002.Caption:=formatfloat('#,0',f1);
    sb003.Caption:=formatfloat('#,0',f2);
    sb004.Caption:=formatfloat('#,0',f3);
    sb005.Caption:=formatfloat('#,0',f4);
    sb006.Caption:=formatfloat('#,0',f5);
    sb007.Caption:=formatfloat('#,0',f6);
    sb008.Caption:=formatfloat('#,0',f7);
end;

procedure Tfrmaqlreport01.ppSummaryBand3BeforePrint(Sender: TObject);
var
  i:integer;
  f1,f2,f3,f4,f5,f6,f7:double;
begin
    if not frmaqlmain.qry_s0.fieldbyname('remarks1').isnull then
    remarks001.Caption:=frmaqlmain.qry_s0.fieldbyname('remarks1').value
    else remarks001.Caption:='';

    i:=0;f1:=0;f2:=0;f3:=0;f4:=0;f5:=0;f6:=0;f7:=0;
    with query1 do begin
      close;
      params.clear;
      params.createparam(ftinteger,'x1',ptinput);
      commandtext:='select * from tbl_aql_s3 where seq=:x1 and (q1>0 or q2>0 or q3>0 or q4>0 or q5>0 or q6>0 or q7>0 or q8>0 or q9>0 or q10>0 or q11>0 or q12>0) order by seq1';
      params[0].asinteger:=frmaqlmain.qry_s0.fieldbyname('seq').value;
      open;
      first;
      while not eof do begin
        i:=i+1;
        f1:=f1+fieldbyname('q1').value;
        f2:=f2+fieldbyname('q2').value;
        f3:=f3+fieldbyname('q3').value;
        f4:=f4+fieldbyname('q4').value;
        f5:=f5+fieldbyname('q5').value;
        f6:=f6+fieldbyname('q6').value;
        f7:=f7+fieldbyname('q7').value;
        application.ProcessMessages;
        next;
      end;
    end;
    sc002.Caption:=formatfloat('#,0',f1);
    sc003.Caption:=formatfloat('#,0',f2);
    sc004.Caption:=formatfloat('#,0',f3);
    sc005.Caption:=formatfloat('#,0',f4);
    sc006.Caption:=formatfloat('#,0',f5);
    sc007.Caption:=formatfloat('#,0',f6);
    sc008.Caption:=formatfloat('#,0',f7);
end;

procedure Tfrmaqlreport01.ppTitleBand1BeforePrint(Sender: TObject);
var
  i:integer;
begin
  with query1 do begin
    close;
    params.Clear;
    params.createparam(ftinteger,'x1',ptinput);
    commandtext:='select sum(major) as q1,sum(minor) as q2 from tbl_aql_s4 where seq=:x1';
    params[0].asinteger:=frmaqlmain.qry_s0.fieldbyname('seq').value;
    open;
    if fieldbyname('q1').isnull then begin
      rx001.Caption:='0';
      sd005.Caption:='0';
      rx002.Visible:=true;
      rx003.Visible:=false;
    end else begin
      rx001.Caption:=fieldbyname('q1').asstring;
      sd005.Caption:=fieldbyname('q1').asstring;
      if fieldbyname('q1').value<=frmaqlmain.qry_s0.fieldbyname('sqty1').value then begin
        rx002.Visible:=true;
        rx003.Visible:=false;
      end else begin
        rx002.Visible:=false;
        rx003.Visible:=true;
      end;
    end;
    if not fieldbyname('q2').isnull then sd006.Caption:=fieldbyname('q2').asstring
    else sd006.Caption:='0';
  end;
  with query1 do begin
    close;
    params.Clear;
    params.createparam(ftinteger,'x1',ptinput);
    commandtext:='select sum(major) as q1 from tbl_aql_s5 where seq=:x1';
    params[0].asinteger:=frmaqlmain.qry_s0.fieldbyname('seq').value;
    open;
    if fieldbyname('q1').isnull then begin
      se005.Caption:='0';
      rx004.Visible:=true;
      rx005.Visible:=false;
    end else begin
      se005.Caption:=fieldbyname('q1').asstring;
      if fieldbyname('q1').value=0 then begin
        rx004.Visible:=true;
        rx005.Visible:=false;
      end else begin
        rx004.Visible:=false;
        rx005.Visible:=true;
      end;
    end;
  end;

  rd001.Caption:='';rd002.Caption:='';rd003.Caption:='';rd004.Caption:='';rd005.Caption:='';rd006.Caption:='';
  rd011.Caption:='';rd012.Caption:='';rd013.Caption:='';rd014.Caption:='';rd015.Caption:='';rd016.Caption:='';
  rd021.Caption:='';rd022.Caption:='';rd023.Caption:='';rd024.Caption:='';rd025.Caption:='';rd026.Caption:='';
  rd031.Caption:='';rd032.Caption:='';rd033.Caption:='';rd034.Caption:='';rd035.Caption:='';rd036.Caption:='';
  rd041.Caption:='';rd042.Caption:='';rd043.Caption:='';rd044.Caption:='';rd045.Caption:='';rd046.Caption:='';
  rd051.Caption:='';rd052.Caption:='';rd053.Caption:='';rd054.Caption:='';rd055.Caption:='';rd056.Caption:='';
  rd061.Caption:='';rd062.Caption:='';rd063.Caption:='';rd064.Caption:='';rd065.Caption:='';rd066.Caption:='';
  rd071.Caption:='';rd072.Caption:='';rd073.Caption:='';rd074.Caption:='';rd075.Caption:='';rd076.Caption:='';
  rd081.Caption:='';rd082.Caption:='';rd083.Caption:='';rd084.Caption:='';rd085.Caption:='';rd086.Caption:='';
  rd091.Caption:='';rd092.Caption:='';rd093.Caption:='';rd094.Caption:='';rd095.Caption:='';rd096.Caption:='';
  rd101.Caption:='';rd102.Caption:='';rd103.Caption:='';rd104.Caption:='';rd105.Caption:='';rd106.Caption:='';
  rd111.Caption:='';rd112.Caption:='';rd113.Caption:='';rd114.Caption:='';rd115.Caption:='';rd116.Caption:='';

  re001.Caption:='';re002.Caption:='';re003.Caption:='';re004.Caption:='';re005.Caption:='';
  re011.Caption:='';re012.Caption:='';re013.Caption:='';re014.Caption:='';re015.Caption:='';
  re021.Caption:='';re022.Caption:='';re023.Caption:='';re024.Caption:='';re025.Caption:='';
  re031.Caption:='';re032.Caption:='';re033.Caption:='';re034.Caption:='';re035.Caption:='';

  i:=0;
  with query1 do begin
    close;
    params.clear;
    params.createparam(ftinteger,'x1',ptinput);
    commandtext:='select * from tbl_aql_s4 where seq=:x1';
    params[0].asinteger:=frmaqlmain.qry_s0.fieldbyname('seq').value;
    open;
    first;
    while not eof do begin
      i:=i+1;
      if i=1 then begin
        if not fieldbyname('siz').isnull then rd001.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd002.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd003.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd004.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd005.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd006.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=2 then begin
        if not fieldbyname('siz').isnull then rd011.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd012.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd013.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd014.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd015.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd016.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=3 then begin
        if not fieldbyname('siz').isnull then rd021.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd022.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd023.Caption:=fieldbyname('eplo').value;
        if not fieldbyname('edef').isnull then rd024.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd025.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd026.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=4 then begin
        if not fieldbyname('siz').isnull then rd031.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd032.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd033.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd034.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd035.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd036.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=5 then begin
        if not fieldbyname('siz').isnull then rd041.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd042.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd043.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd044.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd045.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd046.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=6 then begin
        if not fieldbyname('siz').isnull then rd051.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd052.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd053.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd054.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd055.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd056.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=7 then begin
        if not fieldbyname('siz').isnull then rd061.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd062.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd063.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd064.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd065.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd066.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=8 then begin
        if not fieldbyname('siz').isnull then rd071.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd072.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd073.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd074.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd075.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd076.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=9 then begin
        if not fieldbyname('siz').isnull then rd081.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd082.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd083.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd084.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd085.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd086.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=10 then begin
        if not fieldbyname('siz').isnull then rd091.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd092.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd093.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd094.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd095.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd096.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=11 then begin
        if not fieldbyname('siz').isnull then rd101.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd102.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd103.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd104.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd105.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd106.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=12 then begin
        if not fieldbyname('siz').isnull then rd111.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd112.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd113.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd114.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd115.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd116.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=13 then begin
        if not fieldbyname('siz').isnull then rd121.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd122.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd123.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd124.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd125.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd126.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=14 then begin
        if not fieldbyname('siz').isnull then rd131.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd132.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd133.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd134.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd135.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd136.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=15 then begin
        if not fieldbyname('siz').isnull then rd141.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd142.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd143.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd144.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd145.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd146.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else if i=16 then begin
        if not fieldbyname('siz').isnull then rd151.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then rd152.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then rd153.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then rd154.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then rd155.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
        if not fieldbyname('minor').isnull then rd156.Caption:=formatfloat('#0;-#0;''''',fieldbyname('minor').value);
      end else begin
      end;
      application.ProcessMessages;
      next;
    end;
  end;

  i:=0;
  with query1 do begin
    close;
    params.clear;
    params.createparam(ftinteger,'x1',ptinput);
    commandtext:='select * from tbl_aql_s5 where seq=:x1';
    params[0].asinteger:=frmaqlmain.qry_s0.fieldbyname('seq').value;
    open;
    first;
    while not eof do begin
      i:=i+1;
      if i=1 then begin
        if not fieldbyname('siz').isnull then re001.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then re002.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then re003.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then re004.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then re005.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
      end else if i=2 then begin
        if not fieldbyname('siz').isnull then re011.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then re012.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then re013.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then re014.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then re015.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
      end else if i=3 then begin
        if not fieldbyname('siz').isnull then re021.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then re022.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then re023.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then re024.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then re025.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
      end else if i=4 then begin
        if not fieldbyname('siz').isnull then re031.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then re032.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then re033.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then re034.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then re035.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
      end else if i=5 then begin
        if not fieldbyname('siz').isnull then re041.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then re042.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then re043.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then re044.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then re045.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
      end else if i=6 then begin
        if not fieldbyname('siz').isnull then re051.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then re052.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then re053.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then re054.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then re055.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
      end else if i=7 then begin
        if not fieldbyname('siz').isnull then re061.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then re062.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then re063.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then re064.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then re065.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
      end else if i=8 then begin
        if not fieldbyname('siz').isnull then re071.Caption:=fieldbyname('siz').value;
        if not fieldbyname('acol').isnull then re072.Caption:=fieldbyname('acol').value;
        if not fieldbyname('eplo').isnull then re073.Caption:=fieldbyname('eplo').value+fieldbyname('plo').value;
        if not fieldbyname('edef').isnull then re074.Caption:=fieldbyname('edef').value+fieldbyname('def').value;
        if not fieldbyname('major').isnull then re075.Caption:=formatfloat('#0;-#0;''''',fieldbyname('major').value);
      end else begin
      end;
      application.ProcessMessages;
      next;
    end;
  end;
  if not frmaqlmain.qry_s0.fieldbyname('remarks').isnull then
  ppMemo1.Lines.Text:=frmaqlmain.qry_s0.fieldbyname('remarks').value
  else ppMemo1.Lines.Text:='';
  with query1 do begin
    close;
    params.clear;
    commandtext:='select frep from tbl_aql_ftyrep where fqa=''QA''';
    open;
    if not fieldbyname('frep').isnull then frep001.Caption:=fieldbyname('frep').value;
  end;
end;

end.
