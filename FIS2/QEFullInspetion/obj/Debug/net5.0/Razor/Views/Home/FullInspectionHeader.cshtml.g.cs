#pragma checksum "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "8bb32dc70b5c922348719d4f364d17bf4f6f56fb"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(QEFullInspetion.Models.Home.Views_Home_FullInspectionHeader), @"mvc.1.0.view", @"/Views/Home/FullInspectionHeader.cshtml")]
[assembly:global::Microsoft.AspNetCore.Mvc.Razor.Compilation.RazorViewAttribute(@"/Views/Home/FullInspectionHeader.cshtml", typeof(QEFullInspetion.Models.Home.Views_Home_FullInspectionHeader))]
namespace QEFullInspetion.Models.Home
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#line 1 "D:\Project\QEFullInspetion\QEFullInspetion\Views\_ViewImports.cshtml"
using QEFullInspetion;

#line default
#line hidden
#line 4 "D:\Project\QEFullInspetion\QEFullInspetion\Views\_ViewImports.cshtml"
using DevExtreme.AspNet.Mvc;

#line default
#line hidden
#line 5 "D:\Project\QEFullInspetion\QEFullInspetion\Views\_ViewImports.cshtml"
using QEFullInspetion.Controllers;

#line default
#line hidden
#line 6 "D:\Project\QEFullInspetion\QEFullInspetion\Views\_ViewImports.cshtml"
using System.Security.Claims;

#line default
#line hidden
#line 7 "D:\Project\QEFullInspetion\QEFullInspetion\Views\_ViewImports.cshtml"
using Microsoft.AspNetCore.Mvc;

#line default
#line hidden
#line 9 "D:\Project\QEFullInspetion\QEFullInspetion\Views\_ViewImports.cshtml"
using Microsoft.AspNetCore.Mvc.Localization;

#line default
#line hidden
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"8bb32dc70b5c922348719d4f364d17bf4f6f56fb", @"/Views/Home/FullInspectionHeader.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"251332470f42861d90f80ee159614452477d5f26", @"/Views/_ViewImports.cshtml")]
    public class Views_Home_FullInspectionHeader : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    {
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_0 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("src", new global::Microsoft.AspNetCore.Html.HtmlString("~/js/polyfill.min.js"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_1 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("src", new global::Microsoft.AspNetCore.Html.HtmlString("~/js/exceljs.min.js"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_2 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("src", new global::Microsoft.AspNetCore.Html.HtmlString("~/js/FileSaver.min.js"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_3 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("src", new global::Microsoft.AspNetCore.Html.HtmlString("~/icon/login.png"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_4 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("width", new global::Microsoft.AspNetCore.Html.HtmlString("60"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_5 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("height", new global::Microsoft.AspNetCore.Html.HtmlString("70"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        #line hidden
        #pragma warning disable 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext __tagHelperExecutionContext;
        #pragma warning restore 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner __tagHelperRunner = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner();
        #pragma warning disable 0169
        private string __tagHelperStringValueBuffer;
        #pragma warning restore 0169
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __backed__tagHelperScopeManager = null;
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __tagHelperScopeManager
        {
            get
            {
                if (__backed__tagHelperScopeManager == null)
                {
                    __backed__tagHelperScopeManager = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager(StartTagHelperWritingScope, EndTagHelperWritingScope);
                }
                return __backed__tagHelperScopeManager;
            }
        }
        private global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper;
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
            BeginContext(0, 44, false);
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("script", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "8bb32dc70b5c922348719d4f364d17bf4f6f56fb5963", async() => {
            }
            );
            __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper);
            __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_0);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            EndContext();
            BeginContext(44, 2, true);
            WriteLiteral("\r\n");
            EndContext();
            BeginContext(46, 43, false);
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("script", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "8bb32dc70b5c922348719d4f364d17bf4f6f56fb7138", async() => {
            }
            );
            __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper);
            __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_1);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            EndContext();
            BeginContext(89, 2, true);
            WriteLiteral("\r\n");
            EndContext();
            BeginContext(91, 45, false);
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("script", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "8bb32dc70b5c922348719d4f364d17bf4f6f56fb8313", async() => {
            }
            );
            __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper);
            __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_2);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            EndContext();
            BeginContext(136, 4, true);
            WriteLiteral("\r\n\r\n");
            EndContext();
#line 5 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
  
    ViewData["UserName"] = Context.User.FindFirstValue(ClaimTypes.NameIdentifier);

#line default
#line hidden
            BeginContext(231, 43, true);
            WriteLiteral("\r\n<div style=\"display: inline-flex;\">\r\n    ");
            EndContext();
            BeginContext(274, 53, false);
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("img", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.SelfClosing, "8bb32dc70b5c922348719d4f364d17bf4f6f56fb9855", async() => {
            }
            );
            __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper);
            __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_3);
            __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_4);
            __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_5);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            EndContext();
            BeginContext(327, 50, true);
            WriteLiteral("\r\n    <h2 style=\"margin-top:15px;margin-left:5px\">");
            EndContext();
            BeginContext(378, 19, false);
#line 11 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
                                           Write(Localizer["Header"]);

#line default
#line hidden
            EndContext();
            BeginContext(397, 19, true);
            WriteLiteral("</h2>\r\n</div>\r\n\r\n\r\n");
            EndContext();
            BeginContext(418, 8423, false);
#line 15 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
Write(Html.DevExtreme().DataGrid<QEFullInspetion.Controllers.FullInspectionHeadersViewModel>()
    .ID("GridFullInspectionHeaders")
    .FilterPanel(f => f.Visible(true))
    .StateStoring(s => s.Enabled(true))
    .HeaderFilter(h => h.Visible(true).AllowSearch(true).Height(360))
    .Export(e => e.Enabled(true).Texts(t => t.ExportAll(Localizer["Export all data"].Value)))
    .OnExporting("exporting")

    .FocusedRowEnabled(true)
    //.ColumnAutoWidth(true)
    .Paging(p => p.PageSize(12))
    .Pager(pager =>
    {
        pager.Visible(true);
        pager.DisplayMode(GridPagerDisplayMode.Full);
        pager.ShowInfo(true);
        pager.ShowNavigationButtons(true);
        pager.InfoText("Page {0} of {1} ({2} rows)");
    })

    .DataSource(d => d.WebApi()
        .Controller("FullInspectionHeaders")
        .LoadAction("Get")
        .InsertAction("Post")
        .UpdateAction("Put")
        .DeleteAction("Delete")
        .Key("Oid")
    )
    .ShowBorders(true)
    .RemoteOperations(true)
    .OnEditorPreparing("onEditorPreparing")
    .Columns(columns => {
        columns.AddFor(m => m.Factory).Width(50).Alignment(HorizontalAlignment.Left)
            .SetCellValue("SetFactoryValue")
            .Caption(Localizer["Fty"].Value)
            .HeaderCellTemplate(Localizer["<text><div>Fty</div></text>"].Value)
            .Lookup(lookup => lookup
                .DataSource(d => d.Mvc().Controller("DataHelper").LoadAction("GetFactory").Key("Factory"))
                .DisplayExpr("Factory")
                .ValueExpr("Factory")
            );

        columns.AddFor(m => m.WorkShop).Width(50)
            .AllowEditing(false)
            .Caption(Localizer["Ws"].Value)
            .Alignment(HorizontalAlignment.Left)
            .HeaderCellTemplate(Localizer["<text><div>Ws</div></text>"].Value);

        columns.AddFor(m => m.Line).Width(70)
            .Caption(Localizer["Line#"].Value)
            .AllowSorting(true)
            .SetCellValue("SetWorkShopValue")
            .EditCellTemplate(new TemplateName("LineDropDownBoxTemplate"));

        columns.AddFor(m => m.Project).Width(95)
            .AllowEditing(false)
            .AllowHeaderFiltering(true)
            .Caption(Localizer["Proj#"].Value);

        columns.AddFor(m => m.LWO).Width(160)
            .Alignment(HorizontalAlignment.Left)
            .Caption(Localizer["QN#"].Value)
            .AllowSorting(true)
            .AllowHeaderFiltering(true)
            .SetCellValue("SetStyleNoValue")
            .EditCellTemplate(new TemplateName("LWODropDownBoxTemplate"));

        columns.AddFor(m => m.QNQty).Width(50)
            .Caption(Localizer["QN Qty"].Value)
            .Alignment(HorizontalAlignment.Left)
            .AllowHeaderFiltering(false)
            .HeaderCellTemplate(Localizer["<text><div>QN<br>Qty</div></text>"].Value);

        columns.AddFor(m => m.InspectionQtyShow).Width(75)
            .AllowEditing(false)
            .Alignment(HorizontalAlignment.Left)
            .AllowHeaderFiltering(false)
            .AllowSorting(false)
            .HeaderCellTemplate(Localizer["<text><div>Inspected<br>Qty</div></text>"].Value);

        columns.AddFor(m => m.OutstandingQtyShow).Width(50)
            .AllowEditing(false)
            .Alignment(HorizontalAlignment.Left)
            .AllowHeaderFiltering(false)
            .AllowSorting(false)
            .HeaderCellTemplate(Localizer["<text><div>O/S<br>Qty</div></text>"].Value);

        columns.AddFor(m => m.InspectionConfirmBy).Width(85)
            .AllowFiltering(true)
            .Alignment(HorizontalAlignment.Left)
            .AllowHeaderFiltering(true)
            .HeaderCellTemplate(Localizer["<strong><text><div>Cmpl<br>cfmd by</div></text></strong>"].Value);

        columns.AddFor(m => m.ColorCode).Width(45)
            .AllowEditing(false)
            .Caption(Localizer["Clr Cde"].Value)
            .Alignment(HorizontalAlignment.Left)
            .AllowHeaderFiltering(false)
            .HeaderCellTemplate(Localizer["<text><div>Clr<br>Cde</div></text>"].Value);

        columns.AddFor(m => m.StyleNo)
            .AllowEditing(false)
            .Caption(Localizer["Style#"].Value)
            .Width(80)
            .AllowHeaderFiltering(true);

        columns.AddFor(m => m.QNStartDate).Width(90)
            .AllowEditing(false)
            .AllowSorting(false)
            .Caption(Localizer["QN Start dd"].Value)
            .Format("yyyy-MM-dd")
            .AllowHeaderFiltering(false)
            .HeaderCellTemplate(Localizer["<text><div>QN<br>Start dd</div></text>"].Value);

        //columns.AddFor(m => m.InspectionDate).Format("yyyy-MM-dd").Caption("Insp. dd").Alignment(HorizontalAlignment.Left);
        //columns.AddFor(m => m.Inspector).AllowEditing(false).Caption("Inspector").Alignment(HorizontalAlignment.Left).Width(80);

        columns.AddFor(m => m.LineLeader).Width(85)
            .Caption(Localizer["Line Leader"].Value)
            .Alignment(HorizontalAlignment.Left)
            .AllowHeaderFiltering(true)
            .HeaderCellTemplate(Localizer["<text><div>Line<br>Leader</div></text>"].Value);

        columns.AddFor(m => m.SewingSupervisior).Width(100)
            .Caption(Localizer["S. Supervisor"].Value)
            .Alignment(HorizontalAlignment.Left)
            .AllowHeaderFiltering(true)
            .HeaderCellTemplate(Localizer["<text><div>Sewing<br>Supervisor</div></text>"].Value);


        columns.Add().Name("CommandButton")
           .Caption(Localizer["Function"].Value)
           .Type(GridCommandColumnType.Buttons)
           .Buttons(b =>
           {
               b.Add().Text(Localizer["→Ssheet"].Value).OnClick("OpenDetailForm");
               b.Add().Name(GridColumnButtonName.Edit).Text(Localizer["Edit"].Value);
               b.Add().Text(Localizer["Cmpl cfm"].Value).OnClick("ConfirmCompleted").Visible(Convert.ToBoolean(ViewData["ConfirmCompleteRight"]));
               b.Add().Name(GridColumnButtonName.Delete).Text(Localizer["Delete"].Value);
           });
    })
    .Editing(e => e
        .AllowAdding(Convert.ToBoolean(ViewData["EditRight"]))
        .AllowUpdating(Convert.ToBoolean(ViewData["EditRight"]))
        .AllowDeleting(Convert.ToBoolean(ViewData["DeleteRight"]))

        .Texts(t=> t
            .AddRow(Localizer["Add inspection by QN"].Value)
            .SaveRowChanges(Localizer["Save"].Value)
            .CancelRowChanges(Localizer["Cancel"].Value)
            .ConfirmDeleteMessage(Localizer["Are you sure you want to delete this record?"].Value)
        )
        .Mode(GridEditMode.Popup)
        .Popup(p => p
            .Title(Localizer["QE Full Inspection Info"].Value)
            .ShowTitle(true)
            .Width(700)
            .Height(525)
            
        )

    )
    .OnInitNewRow("OnInitNewRow")
    .OnCellPrepared("OnCellPrepared")
    .OnToolbarPreparing("toolbar_preparing")
    .Summary(s =>
        s.TotalItems(items =>
        {
            items.AddFor(m => m.Factory).SummaryType(SummaryType.Count).CustomizeText("CalTotalFactory");
            items.AddFor(m => m.WorkShop).SummaryType(SummaryType.Count).CustomizeText("CalTotalWorkShop");
            items.AddFor(m => m.Line).SummaryType(SummaryType.Count).CustomizeText("CalTotalLine");
            items.AddFor(m => m.Project).SummaryType(SummaryType.Count).CustomizeText("CalTotalProjectNo");
            items.AddFor(m => m.LWO).SummaryType(SummaryType.Count).CustomizeText("CalTotalQNNO");
            //items.AddFor(m => m.InspectionQtyShow).SummaryType(SummaryType.Count).CustomizeText("CalTotalInspectionQty");
            //items.AddFor(m => m.OutstandingQtyShow).SummaryType(SummaryType.Count).CustomizeText("CalTotalOutstandingQty");
            items.AddFor(m => m.InspectionConfirmBy).SummaryType(SummaryType.Count).CustomizeText("CalTotalInspectionConfirmBy");
            items.AddFor(m => m.StyleNo).SummaryType(SummaryType.Count).CustomizeText("CalTotalCustStyleNo");
            items.AddFor(m => m.LineLeader).SummaryType(SummaryType.Count).CustomizeText("CalTotalLineLeader");
            items.AddFor(m => m.SewingSupervisior).SummaryType(SummaryType.Count).CustomizeText("CalTotalSewingSupervisior");
        })
      )
);

#line default
#line hidden
            EndContext();
            BeginContext(9636, 6, true);
            WriteLiteral("\r\n\r\n\r\n");
            EndContext();
#line 213 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
 using (Html.DevExtreme().NamedTemplate("LineDropDownBoxTemplate"))
{
    

#line default
#line hidden
            BeginContext(9720, 395, false);
#line 215 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
Write(Html.DevExtreme().DropDownBox()
        .DataSource(d => d.Mvc().Controller("DataHelper").LoadAction("GetLine").Key("Line"))
        .Value(new JS("value"))
        .ValueExpr("Line")
        .DisplayExpr("Line")
        .DropDownOptions(options => options.Width(500))
        .Option("setValue", new JS("setValue"))
        .ContentTemplate(new TemplateName("LineContentTemplate"))
    );

#line default
#line hidden
            EndContext();
#line 223 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
     
}

#line default
#line hidden
            BeginContext(10121, 2, true);
            WriteLiteral("\r\n");
            EndContext();
#line 226 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
 using (Html.DevExtreme().NamedTemplate("LineContentTemplate"))
{
    

#line default
#line hidden
            BeginContext(10197, 1036, false);
#line 228 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
Write(Html.DevExtreme().DataGrid()
        .DataSource(d => d.Mvc()
            .Controller("DataHelper")
            .LoadAction("GetLine")
            .LoadParams(new {Factory = new JS("factory") })
            .Key("Line"))
            .RemoteOperations(true)
            .Height(250)
            .Columns(c => {
                c.Add().DataField("Factory").Caption(Localizer["Fty"].Value);
                c.Add().DataField("WorkShop").Caption(Localizer["Ws"].Value);
                c.Add().DataField("Line").Caption(Localizer["Line#"].Value);
            })
        .Scrolling(s => s.Mode(GridScrollingMode.Virtual))
        .HoverStateEnabled(true)
        .RemoteOperations(true)
        .Selection(s => s.Mode(SelectionMode.Single))
        .SelectedRowKeys(new JS("[component.option('value')]"))
        .FocusedRowEnabled(true)
        .FocusedRowKey(new JS("component.option('value')"))
        .OnSelectionChanged("function(selectionChangedArgs) { onSelectionChanged(selectionChangedArgs, component) }")
    );

#line default
#line hidden
            EndContext();
#line 249 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
     
}

#line default
#line hidden
            BeginContext(11239, 2, true);
            WriteLiteral("\r\n");
            EndContext();
#line 252 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
 using (Html.DevExtreme().NamedTemplate("LWODropDownBoxTemplate"))
{
    

#line default
#line hidden
            BeginContext(11318, 390, false);
#line 254 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
Write(Html.DevExtreme().DropDownBox()
        .DataSource(d => d.Mvc().Controller("DataHelper").LoadAction("GetLWO").Key("LWO"))
        .Value(new JS("value"))
        .ValueExpr("LWO")
        .DisplayExpr("LWO")
        .DropDownOptions(options => options.Width(600))
        .Option("setValue", new JS("setValue"))
        .ContentTemplate(new TemplateName("LWOContentTemplate"))
    );

#line default
#line hidden
            EndContext();
#line 262 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
     
}

#line default
#line hidden
            BeginContext(11714, 2, true);
            WriteLiteral("\r\n");
            EndContext();
#line 265 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
 using (Html.DevExtreme().NamedTemplate("LWOContentTemplate"))
{
    

#line default
#line hidden
            BeginContext(11789, 1426, false);
#line 267 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
Write(Html.DevExtreme().DataGrid()
        .DataSource(d => d.Mvc()
            .Controller("DataHelper")
            .LoadAction("GetLWO")
            .LoadParams(new { Line = new JS("line") })
            .Key("LWO"))
            .RemoteOperations(true)
            .Height(250)
            .Columns(c => {
                c.Add().DataField("Line").Width(60).Caption(Localizer["Line#"].Value);
                c.Add().DataField("Project").Width(80).Caption(Localizer["Proj#"].Value);
                c.Add().DataField("LWO").Width(180).Caption(Localizer["QN#"].Value);
                c.Add().DataField("ColorCode").Width(60).Caption(Localizer["Clr Cde"].Value);
                c.Add().DataField("StyleNo").Width(90).Caption(Localizer["Style#"].Value);
                c.Add().DataField("QNQty").Width(90).Caption(Localizer["QN Qty"].Value);
                c.Add().DataField("SeqNo").Width(70).Caption(Localizer["Seq#"].Value);
            })
        .Scrolling(s => s.Mode(GridScrollingMode.Virtual))
        .HoverStateEnabled(true)
        .RemoteOperations(true)
        .Selection(s => s.Mode(SelectionMode.Single))
        .SelectedRowKeys(new JS("[component.option('value')]"))
        .FocusedRowEnabled(true)
        .FocusedRowKey(new JS("component.option('value')"))
        .OnSelectionChanged("function(selectionChangedArgs) { onLWOSelectionChanged(selectionChangedArgs, component) }")
    );

#line default
#line hidden
            EndContext();
#line 292 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
     
}

#line default
#line hidden
            BeginContext(13221, 150, true);
            WriteLiteral("\r\n<script>\r\n    var rightList;\r\n    $(function () {\r\n         $.ajax({\r\n             url: \"/api/Right/GetUserRight\",\r\n             data: { UserName: \'");
            EndContext();
            BeginContext(13372, 20, false);
#line 300 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
                           Write(ViewData["UserName"]);

#line default
#line hidden
            EndContext();
            BeginContext(13392, 211, true);
            WriteLiteral("\', RightObject: \"FullInspectionHeader\" },\r\n             type: \"get\",\r\n             async: false,\r\n             dataType: \"json\",\r\n             success: function (result) {\r\n                 rightList = result;\r\n");
            EndContext();
            BeginContext(14017, 3221, true);
            WriteLiteral(@"             }
        });
    })

    var factory;
    var workShop;
    var line;
    var colorCode;
    var styelNo;
    var project;
    var seqNo;
    var qnQty;
    function onSelectionChanged(selectionChangedArgs, component) {
        var setValue = component.option('setValue');
        var selectedRowKey = selectionChangedArgs.selectedRowKeys[0];
        var data = selectionChangedArgs.selectedRowsData[0];
        workShop = data.WorkShop;
        component.option('value', selectedRowKey);
        setValue(selectedRowKey);
        if (selectionChangedArgs.selectedRowKeys.length > 0) {
            component.close();
        }
    }

    function onLWOSelectionChanged(selectionChangedArgs, component) {
        var setValue = component.option('setValue');
        var selectedRowKey = selectionChangedArgs.selectedRowKeys[0];
        var data = selectionChangedArgs.selectedRowsData[0];
        colorCode = data.ColorCode;
        styelNo = data.StyleNo;
        project = data.P");
            WriteLiteral(@"roject;
        seqNo = data.SeqNo;
        qnQty = data.QNQty;
        component.option('value', selectedRowKey);
        setValue(selectedRowKey);
        if (selectionChangedArgs.selectedRowKeys.length > 0) {
            component.close();
        }
    }

    function SetWorkShopValue(newData, value, currentRowData) {
        newData.Line = value;
        newData.WorkShop = workShop;
        line = value;

        //通過Line取得Line Leader、Sewing Supervisor
        $.ajax({
            url: ""/api/DataHelper/GetPersonnelInformation"",
            data: { Factory: factory, Line: line },
            type: ""get"",
            async: false,
            dataType: ""json"",
            success: function (result) {
                if (result.data.length > 0) {
                    //DevExpress.ui.notify(""取人员信息成功"");
                    newData.LineLeader = result.data[0].LineLeader;
                    newData.SewingSupervisior = result.data[0].SewingSupervisor;
                    //newDate.Insp");
            WriteLiteral(@"ector = result.EndlineInspector;
                }
                else {
                    DevExpress.ui.notify(""取人员信息失败"");
                }
            }
        });
    }

    function SetFactoryValue(newData, value, currentRowData) {
        newData.Factory = value;
        factory = value;
    }

    function SetStyleNoValue(newData, value, currentRowData) {
        newData.LWO = value;
        newData.ColorCode = colorCode;
        newData.StyleNo = styelNo;
        newData.Project = project;
        newData.SeqNo = seqNo;
        newData.QNQty = qnQty;
    }

    function onEditorPreparing(e) {
        factory = e.row.data.Factory;
        line = e.row.data.Line;
    }

    function OpenDetailForm(e) {
        window.location.href = ""/Home/FullInspectionDetail?FullInspectionHeader="" + e.row.data.Oid + ""&OnlyShowTodayData=1"" +
            ""&Fty="" + e.row.data.Factory + ""&Ws="" + e.row.data.WorkShop + ""&Line="" + e.row.data.Line +
            ""&ProjectNo="" + e.row.data.Pro");
            WriteLiteral("ject + \"&QNNo=\" + e.row.data.LWO;\r\n    }\r\n\r\n    function OnInitNewRow(e) {\r\n        e.data.InspectionDate = new Date();\r\n        e.data.Inspector = \'");
            EndContext();
            BeginContext(17239, 20, false);
#line 408 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
                       Write(ViewData["UserName"]);

#line default
#line hidden
            EndContext();
            BeginContext(17259, 610, true);
            WriteLiteral(@"';
    }


    function OnCellPrepared(e) {
        if (e.rowType == ""header"") {
            if (e.column.name == ""QNQty"" || e.column.name == ""InspectionQtyShow"" || e.column.name ==""OutstandingQtyShow"" ||
                e.column.name == ""InspectionConfirmBy"" ||
                e.column.name == ""InspectionDate"" || e.column.name == ""Inspector"") {
                e.cellElement.css(""backgroundColor"", ""rgb(235, 241, 222)"");
            }
            else if (e.column.name != ""CommandButton"") {
                e.cellElement.css(""backgroundColor"", ""rgb(197, 217, 241)"");
            }
        }
");
            EndContext();
            BeginContext(18132, 390, true);
            WriteLiteral(@"    }

    function ConfirmCompleted(e) {
        //var grid = $(""#GridFullInspectionHeaders"").dxDataGrid(""instance"");
        var grid = e.component;
        var index = e.row.rowIndex;
        var confirmValue = grid.cellValue(index, ""InspectionConfirmBy"");
        if (confirmValue == null || confirmValue.length == 0) {
            grid.cellValue(index, ""InspectionConfirmBy"", '");
            EndContext();
            BeginContext(18523, 20, false);
#line 437 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
                                                     Write(ViewData["UserName"]);

#line default
#line hidden
            EndContext();
            BeginContext(18543, 73, true);
            WriteLiteral("\');\r\n            grid.saveEditData();\r\n            DevExpress.ui.notify(\'");
            EndContext();
            BeginContext(18617, 44, false);
#line 439 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
                             Write(Localizer["The complete confirm is success"]);

#line default
#line hidden
            EndContext();
            BeginContext(18661, 97, true);
            WriteLiteral("\', \'success\');\r\n            return;\r\n        }\r\n        else {\r\n            if (confirmValue == \'");
            EndContext();
            BeginContext(18759, 20, false);
#line 443 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
                            Write(ViewData["UserName"]);

#line default
#line hidden
            EndContext();
            BeginContext(18779, 35, true);
            WriteLiteral("\') {\r\n                if (confirm(\'");
            EndContext();
            BeginContext(18815, 43, false);
#line 444 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
                        Write(Localizer["Do you want to cancel confirm?"]);

#line default
#line hidden
            EndContext();
            BeginContext(18858, 163, true);
            WriteLiteral("\')){\r\n                    grid.cellValue(index, \"InspectionConfirmBy\", null);\r\n                    grid.saveEditData();\r\n                    DevExpress.ui.notify(\'");
            EndContext();
            BeginContext(19022, 42, false);
#line 447 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
                                     Write(Localizer["The cancel confirm is success"]);

#line default
#line hidden
            EndContext();
            BeginContext(19064, 108, true);
            WriteLiteral("\', \'success\');\r\n                }\r\n            }\r\n            else {\r\n                DevExpress.ui.notify(\'");
            EndContext();
            BeginContext(19173, 53, false);
#line 451 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
                                 Write(Localizer["The current QN is cmpl, but not yet shpd"]);

#line default
#line hidden
            EndContext();
            BeginContext(19226, 281, true);
            WriteLiteral(@"', 'error');
            }
        }
    }


    function toolbar_preparing(e) {
        var dataGrid = e.component;

        e.toolbarOptions.items.unshift({
            location: ""after"",
            widget: ""dxButton"",
            options: {
                text: '");
            EndContext();
            BeginContext(19508, 24, false);
#line 464 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
                  Write(Localizer["View Report"]);

#line default
#line hidden
            EndContext();
            BeginContext(19532, 221, true);
            WriteLiteral("\',\r\n                onClick: function (e) {\r\n                    window.open(\"/Home/IncompleteList\");\r\n                    //window.location.href = \"/Home/IncompleteList\";\r\n                }\r\n            }\r\n        },\r\n\r\n");
            EndContext();
            BeginContext(20145, 163, true);
            WriteLiteral("\r\n            {\r\n            location: \"after\",\r\n            widget: \"dxButton\",\r\n            options: {\r\n                icon: \"refresh\",\r\n                hint: \'");
            EndContext();
            BeginContext(20309, 20, false);
#line 489 "D:\Project\QEFullInspetion\QEFullInspetion\Views\Home\FullInspectionHeader.cshtml"
                  Write(Localizer["Refresh"]);

#line default
#line hidden
            EndContext();
            BeginContext(20329, 2710, true);
            WriteLiteral(@"',
                onClick: function () {
                    dataGrid.refresh();
                }
            }
        });
    }

    function exporting(e) {
        var workbook = new ExcelJS.Workbook();
        var worksheet = workbook.addWorksheet('Sheet1');

        DevExpress.excelExporter.exportDataGrid({
            component: e.component,
            worksheet: worksheet,
            autoFilterEnabled: true
        }).then(function () {
            workbook.xlsx.writeBuffer().then(function (buffer) {
                saveAs(new Blob([buffer], { type: 'application/octet-stream' }), 'End-line inspection Header List.xlsx');
            });
        });
        e.cancel = true;
    }

    var totalFactory;
    var totalWorkShop;
    var totalLine;
    var totalProjectNo;
    var totalQNNO;
    //var totalInspectionQty;
    //var totalOutstandingQty;
    var totalInspectionConfirmBy;
    var totalCustStyleNo;
    var totalLineLeader;
    var totalSewingSupervisior;
    f");
            WriteLiteral(@"unction CalTotalFactory(data) {
        $.ajax({
            url: ""/api/FullInspectionHeaders/GetHeaderListTotalInformation"",
            type: ""get"",
            async: false,
            dataType: ""json"",
            success: function (result) {
                totalFactory = result.TotalFactory,
                totalWorkShop = result.TotalWorkShop;
                totalLine = result.TotalLine,
                totalProjectNo = result.TotalProjectNo,
                totalQNNO = result.TotalQNNO,
                //totalInspectionQty = result.TotalInspectionQty,
                //totalOutstandingQty = result.TotalOutstandingQty,
                totalInspectionConfirmBy = result.InspectionConfirmBy;
                totalCustStyleNo = result.TotalCustStyleNo,
                totalLineLeader = result.TotalLineLeader,
                totalSewingSupervisior = result.TotalSewingSupervisior
            }
        });
        return totalFactory;
    }
    function CalTotalWorkShop(data) { return ");
            WriteLiteral(@"totalWorkShop; }
    function CalTotalLine(data) { return totalLine; }
    function CalTotalProjectNo(data) { return totalProjectNo; }
    function CalTotalQNNO(data) { return totalQNNO; }
    //function CalTotalInspectionQty(data) { return totalInspectionQty; }
    //function CalTotalOutstandingQty(data) { return totalOutstandingQty; }
    function CalTotalInspectionConfirmBy(data) { return totalInspectionConfirmBy; }
    function CalTotalCustStyleNo(data) { return totalCustStyleNo; }
    function CalTotalLineLeader(data) { return totalLineLeader; }
    function CalTotalSewingSupervisior(data) { return totalSewingSupervisior; }

</script>

");
            EndContext();
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public IViewLocalizer Localizer { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; }
    }
}
#pragma warning restore 1591
